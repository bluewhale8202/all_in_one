{% extends "info/info_base.html" %}

{% block title %} 교환요청 조회 {% endblock %}

{% block script %}
<script>
    $(function() {
        // Currently, ESM allows only one row to be sellected
        // so we apply the same restriction to the checkboxes
        $('input:checkbox').on('click', function() {
            $('input:checkbox').not(this).prop('checked', false);
        });

        $('#confirm').on('submit', function(e){
            e.preventDefault();
            var oinfs = $("input:checked").parents("tr").find("input").serialize();
            var company = $("input:checked").parents("tr").find("select").serialize();
            var csrf = $("#confirm input[name='csrfmiddlewaretoken']").serialize();

            $.post({
                    url: "{% url 'info:toexchange_confirm' %}",
                    data: oinfs + "&" + company + "&" + csrf,
                    success: function(result,status,xhr) {
                        if (result['status'] === "ok"){ alert("배송등록 성공\n" + result['msg']);
                            location.reload(); }
                        else { alert(result['msg']); location.reload(); }
                    },
            });
        });
    });
</script>
{% endblock %}

{% block submit_value %}
교환처리
{% endblock %}

{% block custom_fields_label %}
<th style="color:blue">주문번호</th>
<th style="color:blue">교환상태</th>
<th style="color:blue">교환요청일</th>
<th style="color:blue">택배사 선택</th>
<th style="color:blue">송장번호</th>
<th style="color:blue">__구매자</th>
{% endblock %}

{% block custom_fields_esm %}
<td>{{ entry.OrderNo }}</td>
<td>{{ entry.StatusName }}</td>
<td>{{ entry.ClaimRegDate }}</td>
<td>
    <select name="resendCompCode">
        <option value="000000014^대한통운">대한통운</option>
        <option value="000000015^한진택배">한진택배</option>
        <option value="000000011^우체국택배">우체국택배</option>
        <option value="100000016^롯데택배">롯데택배</option>
        <option value="100000228^롯데국제특송">롯데국제특송</option>
        <option value="000000023^로젠택배">로젠택배</option>
        <option value="100000070^KG로지스">KG로지스</option>
        <option value="100000077^이노지스택배">이노지스택배</option>
        <option value="100000225^편의점택배(GS25)">편의점택배(GS25)</option>
        <option value="100000214^GTX로지스">GTX로지스</option>
        <option value="100000065^하나로택배">하나로택배</option>
    </select>
</td>
<td>
    <input type="text" name="invoiceNo" value="">
</td>
<td>
{{ entry.BuyerId }},{{ entry.BuyerName }},
{{ entry.BuyerInfoCp }},{{ entry.BuyerInfoHt }}
</td>
{% endblock %}

{% block custom_fields_storefarm %}
<td>{{ entry.PRODUCT_ORDER_ID }}</td>    {# different from OrderNo #}
<td>{{ entry.CLAIM_STATUS }}</td>
<td>{{ entry.CLAIM_REQUEST_OPERATION_YMDT_EXCHANGE }}</td>
<td>
    <select name="resendCompCode">
    </select>
</td>
<td>
    <input type="text" name="invoiceNo" value="">
</td>
<td>-</td>
{% endblock %}

{% comment %}

{% block content %}
    <style>
        table, td, th{
            border: 1px solid black;
            white-space:nowrap;
        }
        th{ text-align: center; }
        td{ padding: 5px; }
        ul li { display: inline; }
    </style>
    <div id="search">
        <form action="." method="post">
            {{ search_form.as_p }}

            {% csrf_token %}
            <input type="submit" value="Search">
        </form>
    </div>
    <script>
    $(function() {
        // Currently, ESM allows only one row to be sellected
        // so we apply the same restriction to the checkboxes
        $('input:checkbox').on('click', function() {
            $('input:checkbox').not(this).prop('checked', false);
        });

        $('#confirm').on('submit', function(e){
            e.preventDefault();
            var oinfs = $("input:checked").parents("tr").find("input").serialize();
            var company = $("input:checked").parents("tr").find("select").serialize();
            var csrf = $("#confirm input[name='csrfmiddlewaretoken']").serialize();

            $.post({
                    url: "{% url 'info:toexchange_confirm' %}",
                    data: oinfs + "&" + company + "&" + csrf,
                    success: function(result,status,xhr) {
                        if (result['status'] === "ok"){ alert("배송등록 성공\n" + result['msg']);
                            location.reload(); }
                        else { alert(result['msg']); location.reload(); }
                    },
            });
        });
    });
    </script>
    <form id="confirm" action="" method="post">
        <input type="submit" value="교환처리">
        {% csrf_token %}
        <table>
            <tr>
                <th style="min-width:30px">선택</th>
                <th style="color:blue">사이트</th>
                <th style="color:blue">몰 ID</th>

                <th style="color:blue">주문번호</th>
                <th style="color:blue">교환상태</th>
                <th style="color:blue">교환요청일</th>

                <th style="color:blue">택배사 선택</th>
                <th style="color:blue">송장번호</th>

                <th style="color:blue">구매자ID</th>
                <th style="color:blue">구매자</th>
                <th style="color:blue">전화번호1</th>
                <th style="color:blue">전화번호2</th>

                <th style="color:blue">상품명</th>
                <th style="color:blue">상품번호</th>
                <th style="color:blue">카트번호</th>
                <th style="color:blue">판매가</th>
                <th style="color:blue">입금일</th>

                <th style="color:blue">배송타입</th>
                <th style="color:blue">배송주소</th>
                <th style="color:blue">수취인이름</th>
                <th style="color:blue">수취인전화번호1</th>
                <th style="color:blue">수취인전화번호2</th>
            </tr>
            {% for entry in entries %}
            {% if entry.site__ in "ESM/GMKT/AUC" %}
            <tr class="esm">
                <td><input style="margin: 0 8px 0" type="checkbox" name="orderInfo"
                    value="{{ entry.site__ }}/{{ entry.ESMID }}/{{ entry.OrderNo }},{{ entry.SiteIdValue }},{{ entry.SellerCustNo }}"></td>
                <td> {{ entry.site__ }}</td>
                <td>{{ entry.SellerId }}</td>

                <td>{{ entry.OrderNo }}</td>
                <td>{{ entry.StatusName }}</td>
                <td>{{ entry.ClaimRegDate }}</td>

                <td>
                    <select name="resendCompCode">
                        <option value="000000014^대한통운">대한통운</option>
                        <option value="000000015^한진택배">한진택배</option>
                        <option value="000000011^우체국택배">우체국택배</option>
                        <option value="100000016^롯데택배">롯데택배</option>
                        <option value="100000228^롯데국제특송">롯데국제특송</option>
                        <option value="000000023^로젠택배">로젠택배</option>
                        <option value="100000070^KG로지스">KG로지스</option>
                        <option value="100000077^이노지스택배">이노지스택배</option>
                        <option value="100000225^편의점택배(GS25)">편의점택배(GS25)</option>
                        <option value="100000214^GTX로지스">GTX로지스</option>
                        <option value="100000065^하나로택배">하나로택배</option>
                    </select>
                </td>
                <td>
                    <input type="text" name="invoiceNo" value="">
                </td>

                <td>{{ entry.BuyerId }}</td>
                <td>{{ entry.BuyerName }}</td>
                <td>{{ entry.BuyerInfoCp }}</td>
                <td>{{ entry.BuyerInfoHt }}</td>

                <td>{{ entry.GoodsName | safe}}</td>
                <td>{{ entry.GoodsNo }}</td>
                <td>{{ entry.CartNo }}</td>
                <td>{{ entry.SellPrice }}</td>
                <td>{{ entry.DepositConfirmDate }}</td>

                <td>{{ entry.DeliveryFeeType }}</td>
                <td style="min-width:200px">{{ entry.RcverInfoAd | safe}}</td>
                <td> {{ entry.RcverName }}</td>
                <td>{{ entry.RcverInfoCp }}</td>
                <td>{{ entry.RcverInfoHt }}</td>
            </tr>

            {% elif entry.site__ == "STOREFARM" %}
            <tr class="storefarm">
                <td><input style="margin: 0 8px 0" type="checkbox" name="orderInfo"
                    value="-/-/-"></td>
                <td> {{ entry.site__ }}</td>
                <td> {{ entry.userid }} </td> {# id #}

                <td>{{ entry.PRODUCT_ORDER_ID }}</td>    {# different from OrderNo #}
                <td>{{ entry.CLAIM_STATUS }}</td>
                <td>{{ entry.CLAIM_REQUEST_OPERATION_YMDT_EXCHANGE }}</td>

                <td>
                    <select name="resendCompCode">
                        {# <option value="000000014^대한통운">대한통운</option>
                        <option value="000000015^한진택배">한진택배</option>
                        <option value="000000011^우체국택배">우체국택배</option>
                        <option value="100000016^롯데택배">롯데택배</option>
                        <option value="100000228^롯데국제특송">롯데국제특송</option>
                        <option value="000000023^로젠택배">로젠택배</option>
                        <option value="100000070^KG로지스">KG로지스</option>
                        <option value="100000077^이노지스택배">이노지스택배</option>
                        <option value="100000225^편의점택배(GS25)">편의점택배(GS25)</option>
                        <option value="100000214^GTX로지스">GTX로지스</option>
                        <option value="100000065^하나로택배">하나로택배</option>#}
                    </select>
                </td>
                <td>
                    <input type="text" name="invoiceNo" value="">
                </td>

                <td>{{ entry.ORDER_ORDER_MEMBER_ID }}</td>
                <td>{{ entry.ORDER_ORDER_MEMBER_NAME }}</td>
                <td>{{ entry.ORDER_MEMBER_TELEPHONE_NO }}</td>
                <td> - </td>

                <td>{{ entry.OPRODUCT_ORDER_PRODUCT_PRODUCT_NAME | safe}}</td>
                <td>{{ entry.OPRODUCT_ORDER_PRODUCT_PRODUCT_NO }}</td>
                <td>{{ entry.OPRODUCT_ORDER_PRODUCT_UNIT_PRICE }}</td>
                <td>{{ entry.PAY_PAY_YMDT }}</td>
                <td> - </td>
                <td> {{ entry.ORDER_DELIVERY_FEE_BUNDLE_GROUP_SEQ }} </td>

                <td> - </td>
                {# <td>배송주소</td>#}
                <td> - </td>
                <td> - </td>
                <td> - </td>
            </tr>
            {% endif %}
            {% endfor %}
        </table>
    </form>

{% endblock %}
{% endcomment %}


{% comment %}
<select class="selectType01 native" id="resendCompCode" name="resendCompCode" style="width:253px;"><option value="100000012^CJ택배">CJ택배</option>
<option value="000000014^대한통운">대한통운</option>
<option value="000000015^한진택배">한진택배</option>
<option value="000000011^우체국택배">우체국택배</option>
<option value="100000016^롯데택배">롯데택배</option>
<option value="100000228^롯데국제특송">롯데국제특송</option>
<option value="000000023^로젠택배">로젠택배</option>
<option value="100000070^KG로지스">KG로지스</option>
<option value="100000077^이노지스택배">이노지스택배</option>
<option value="100000225^편의점택배(GS25)">편의점택배(GS25)</option>
<option value="100000214^GTX로지스">GTX로지스</option>
<option value="100000065^하나로택배">하나로택배</option>
<option value="100000075^일양택배">일양택배</option>
<option value="100000055^천일택배">천일택배</option>
<option value="100000045^대신택배">대신택배</option>
<option value="100000010^경동택배">경동택배</option>
<option value="100000227^합동택배">합동택배</option>
<option value="100000201^SC로지스">SC로지스</option>
<option value="100000090^DHL">DHL</option>
<option value="100000206^FEDEX">FEDEX</option>
<option value="100000224^CJ국제특송">CJ국제특송</option>
<option value="100000220^한진정기화물">한진정기화물</option>
<option value="100000221^OCS KOREA">OCS KOREA</option>
<option value="100000017^등기우편">등기우편</option>
<option value="100000030^퀵서비스">퀵서비스</option>
<option value="100000060^LG전자물류">LG전자물류</option>
<option value="100000048^삼성전자물류">삼성전자물류</option>
<option value="100000046^대우전자물류">대우전자물류</option>
<option value="100000230^위니아물류">위니아물류</option>
<option value="100000044^기타가전물류">기타가전물류</option>
<option value="100000041^가구직배송">가구직배송</option>
<option value="100000019^자체배송">자체배송</option>
<option value="100000059^EMS">EMS</option>
<option value="100000050^양양택배">양양택배</option>
<option value="400000021^(소형항공)우체국">(소형항공)우체국</option>
<option value="100000027^한국택배">한국택배</option>
<option value="100000199^USPS">USPS</option>
<option value="100000200^UPS">UPS</option>
<option value="100000057^호남택배">호남택배</option>
<option value="100000212^GSMNTON">GSMNTON</option>
<option value="100000213^WarpEx">WarpEx</option>
<option value="100000078^성원글로벌">성원글로벌</option>
<option value="100000056^하이브랜로지스">하이브랜로지스</option>
<option value="100000202^국제정보통신">국제정보통신</option>
<option value="100000205^홈플러스택배">홈플러스택배</option>
<option value="100000209^영풍문고택배">영풍문고택배</option>
<option value="100000042^건영택배">건영택배</option>
<option value="100000062^WIZWA">WIZWA</option>
<option value="100000063^FHL express">FHL express</option>
<option value="100000076^Airboy express">Airboy express</option>
<option value="400000011^(해외)우체국">(해외)우체국</option>
<option value="400000031^(해외)DHL">(해외)DHL</option>
<option value="400000211^(해외)DPD">(해외)DPD</option>
<option value="500000014^(지정)대한통운">(지정)대한통운</option>
<option value="100000039^(통합)한진택배">(통합)한진택배</option>
<option value="100000231^SLX">SLX</option>
<option value="100000232^동부대우전자">동부대우전자</option>
<option value="100000233^범한판토스">범한판토스</option>
<option value="100000234^GPS LOGIX">GPS LOGIX</option>
<option value="100000235^한의사랑택배">한의사랑택배</option>
</select>
{% endcomment %}
